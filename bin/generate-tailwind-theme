#!/usr/bin/env node

const fs = require('fs');
const resolveConfig = require('tailwindcss/resolveConfig');
const prettier = require('prettier');
const path = require('path');

const tailwindConfig = require('../tailwind.config.js');
const prettierOptions = require('../.prettierrc.js');

const {
  theme: { colors, screens, fontSize, fontFamily },
} = resolveConfig(tailwindConfig);

const config = {
  colors,
  screens,
  fontSize,
  fontFamily,
};

const themeStr = JSON.stringify(config);
const ts = `
// DO NOT EDIT this file manually. Auto-generated file.
// use "yarn build-theme" to regenerate

export const tailwindTheme = ${themeStr}
`;

try {
  fs.writeFileSync(
    path.resolve(process.cwd(), './src/styles/tailwind-theme-generated.ts'),
    prettier.format(ts, { parser: 'babel', ...prettierOptions }),
    'utf-8'
  );
} catch (err) {
  console.log(err.message);
}
